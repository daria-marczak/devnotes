# Testing React applications with Jest

## Regression
One person adds a new features which improves some views. They are now correct. Another person modifies the new feature but is not aware of breaking effects on a feature. Their view looks good so dev commits changes what causes the another view to regress to unintended state. Tests help as they will fail and we can see what has been done.

## Types of tests
|Type|What it tests|Required tools|
|:---|:------------|:-------------|
|Unit test|A single function or service|Mocha / Jest|
|Component Test|A single component (functionality)|Jest / Enzyme|
|Snapshot|A single component (regression)|Jest|
|End-to-End test|Interaction between multiple components|Protractor / Cypress|

### Unit tests
+ Verifies the functionality of a class or methos
+ Simplest to write and execute
+ Used to test correctnes of application logic
+ Tests can be written prior to application (Test Driven Development)

### Component tests
+ Verifies the correct appearance and functionning of a component
+ Highly sensitive to small changes to underlying components and services
+ Provides a strong defense against regression
+ Verifies changes to component output in response to change in application state
+ Does not verify interactions between two components

### Snapshot tests
+ A subtype of component tests
+ Automatically generated by Jest
+ Verifies output matches pas record
+ Tends to fail if even the slightest change occurs

### Performance tests
+ Measure how long a block of code takes to execute
+ Can identify bottlenecks in application performance
+ Can provide insight into performance differences on different devices and cloud

### Coverage tests
+ A test for your tests
+ Measures application code which is visited (but not necessarily verified) during tests
+ Does not indicate whether application works or not, but it is nice to have

### End-to-End tests
+ Measures the functionality of the whole app
+ Often executed in a virtual or “headless” browser
+ Creates a scenario to test by simulating user actions
+ Different in nature and more difficult to write than other tests
+ Provide the best assurance that the app works

## Jest
+ A library installed via npm or yarn and run via the command line
+ Similar to popular test-runners but with handy extra features
+ A tool made by a team including members of React team
+ Adds snapshot testing, mocking and many other useful features
+ Includes superior assertion library, CLI
+ Works with or without React

### Jest testing ecosystem
+ Enzyme
+ Jasmine / Mocha (Jest is built on top of it)

#### Jasmine / Mocha
+ Test-runners that organizes tests into "describe" and "it" blocks (or "suite" and "test")
+ All assertions inside test are verified whenever the test-runner is invoked, e.g. with command line
+ Doesn't include mocking or snapshots

#### Enzyme
+ Not a test runner like Jest, but provides tools to test React apps specifically
+ Expresses component output as HTML (like React test renderer)
+ Potentially useful but not for every project

### Jest vs Mocha
|Function|Jest|Mocha|
|:-------|:---|:----|
|Runs tests|Yes|Yes|
|Asynchronous|Yes|Yes|
|Spies included|Yes|No|
|Snapshot testing|Yes|No|
|Module mocking|Yes|No|


### Jest CLI
A tool that we use to run Jest from the command line and provides configuration options to Jest

Test files can be named either **.spec.js* or **.test.js*

#### Tests in their own folder
|Test in their own folder|Test alongside components|
|:-----------------------|:------------------------|
|Easily distniguish between test and non-test files|Which files are components and which files are spec is not as obvious|
|Unrelated files can share a folder (i.e. a "loginService" test and a "cryptoHash" test|Tests are always adjacent to the files they apply to|
|Very easy to isolate a prticular set of tests that are in the same folder|Unrelated tests are less likely to share a folder|
|Tests can be named anything but must be inside an appropriately named folder (i.e. __ tests __), to be recognized|Tests must have a correct naming pattern to be recognized, i.e. *.test.js |
||Possible to isolate tests based on name paterns, i.e., user-*|

### Jest globals
+ It (test) – method which you pass a function to, that function is executed as block of tests by the test runner
+ Describe (suite) – an optional method for grouping any number of it statements
